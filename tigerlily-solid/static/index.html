<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Liquid & Solid</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  
    <link rel="stylesheet" href="file/style.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content presentation-cover" ref="one/01_slide/1">
<h1>Liquid &amp; Solid</h1>

<p><img src="./file/one/tigerlily-cover.jpg" alt="tigerlily-cover"/></p></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/2">
<h1>Tigerlily</h1>

<p>Tigerlily &#xE9;dite une plateforme &#xE0; destination des grands comptes, qui leur permet de g&#xE9;rer de fa&#xE7;on simple et efficace leurs actions de social marketing</p></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/3">
<h1>Liquid - Qu'est-ce que c'est ?</h1>

<ul>
<li>Impl&#xE9;mentation Ruby du moteur de template de Django</li>
<li>Cr&#xE9;e par Shopify</li>
<li>Son seul int&#xE9;r&#xEA;t: &#xEA;tre utilis&#xE9; comme bac &#xE0; sable</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/4">
<h1>Liquid - Bac &#xE0; sable</h1>

<pre class="sh_html"><code>  &lt;p&gt;&lt;% User.delete_all %&gt; Pwned !&lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/5">
<h1>Sommaire</h1>

<ul>
<li>Liquid

<ul>
<li>Aper&#xE7;u</li>
<li>S&#xE9;curit&#xE9;</li>
<li>Extension</li>
<li>Performance</li>
</ul>
</li>
<li>Solid

<ul>
<li>Aper&#xE7;u</li>
<li>Tags / Block</li>
<li>Template</li>
<li>ModelDrop</li>
</ul>
</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/6">
<h1>Aper&#xE7;u</h1>

<pre class="sh_html"><code>    {% for story in story_list %}
    &lt;h2&gt;
      &lt;a href="{% url_to story %}"&gt;
        {{ story.headline }}
      &lt;/a&gt;
    &lt;/h2&gt;
    &lt;p&gt;{{ story.tease|escape }}&lt;/p&gt;
    {% endfor %}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/7">
<h1>Utilisation</h1>

<pre class="sh_ruby"><code>    template = Liquid::Template.parse('Hello {{ person }}')
    puts template.render('person' =&gt; 'Homer')</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/8">
<h1>S&#xE9;curit&#xE9;</h1>

<ul>
<li>Liquid::Drop</li>
<li>Module#liquid_methods</li>
<li>Object#to_liquid</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/9">
<h1>S&#xE9;curit&#xE9; - Liquid::Drop</h1>

<pre class="sh_ruby"><code>    class ShopDrop &lt; Liquid::Drop

      def top_sales
        Shop.current.products.find(:all, :order =&gt; 'sales', :limit =&gt; 10 )
      end

      def before_method(method_name)
        Shop.current.send(method_name) if Shop.column_names.include?(method_name)
      end

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/10">
<h1>S&#xE9;curit&#xE9; - Module#liquid_methods</h1>

<pre class="sh_ruby"><code>    class Shop

      liquid_methods :top_sales

      def top_sales
        Shop.current.products.find(:all, :order =&gt; 'sales', :limit =&gt; 10 )
      end

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/11">
<h1>S&#xE9;curit&#xE9; - #to_liquid</h1>

<pre class="sh_ruby"><code>    class Shop

      def to_liquid
        self
      end

      def top_sales
        Shop.current.products.find(:all, :order =&gt; 'sales', :limit =&gt; 10 )
      end

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/12">
<h1>S&#xE9;curit&#xE9; - #to_liquid</h1>

<pre class="sh_html"><code>    &lt;p&gt;{{ shop.class.delete_all }} Pwned !&lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/13">
<h1>Extension</h1>

<ul>
<li>Filters</li>
<li>Tags</li>
<li>Block</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/14">
<h1>Extension - Filters</h1>

<pre class="sh_html"><code>    &lt;p&gt;{{ my_list|join:", " }}&lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/15">
<h1>Extension - Filters</h1>

<pre class="sh_ruby"><code>    module MyFilters

      def join(input, glue=' ')
        input.join(glue)
      end

    end

    Liquid::Template.register_filter(MyFilters)</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/16">
<h1>Extension - Tags</h1>

<pre class="sh_html"><code>    &lt;p&gt;{% random 5 %}&lt;/p&gt;
    &lt;!-- produce --&gt;
    &lt;p&gt;3&lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/17">
<h1>Extension - Tags</h1>

<pre class="sh_ruby"><code>    class Random &lt; Liquid::Tag
      def initialize(tag_name, max, tokens)
        super
        @max = max.to_i
      end

      def render(context)
        rand(@max).to_s
      end
    end

    Liquid::Template.register_tag('random', Random)</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/18">
<h1>Extension - Block</h1>

<pre class="sh_html"><code>    {% random 5 %}
      &lt;p&gt;Wanna hear a joke?&lt;p&gt;
    {% endrandom %}

    &lt;!-- In 20% of the cases, produce: --&gt;

    &lt;p&gt;Wanna hear a joke?&lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/19">
<h1>Extension - Block</h1>

<pre class="sh_ruby"><code>    class Random &lt; Liquid::Block
      def initialize(tag_name, markup, tokens)
        super
        @rand = markup.to_i
      end

      def render(context)
        if rand(@rand) == 0
          super
        else
          ''
        end
      end
    end

    Liquid::Template.register_tag('random', Random)</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/20">
<h1>Extension - Multipart Block</h1>

<pre class="sh_html"><code>    &lt;p&gt;
    {% if_already_voted_on post %}
        Remove my vote
    {% else %}
        Vote
    {% endif_already_voted_on %}
    &lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/21">
<h1>Extension - Multipart Block</h1>

<pre class="sh_ruby"><code>    class IfAlreadyVotedOn &lt; Liquid::Block

      def initialize(tag_name, variable, tokens)
        @variable = variable
        @blocks = []
        push_block!
        super
      end

      def render(context)
        context.stack do
          current_user = context['current_user']
          post = context[@variable]
          block = current_user.already_voted_on?(post) ? @blocks.first : @blocks.last
          return render_all(block, context)
        end
      end

      ## snip ....</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/22">
<h1>Extension - Multipart Block</h1>

<pre class="sh_ruby"><code>      def unknown_tag(tag, markup, tokens)
        if tag == 'else'
          push_block!
        else
          super
        end
      end

      private

      def push_block!
        block = []
        @blocks.push(block)
        @nodelist = block
      end

    end

    Template.register_tag('if_already_voted_on', IfAlreadyVotedOn)</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/23">
<h1>Performance - Parsing</h1>

<ul>
<li>D&#xE9;centes</li>
<li>Lin&#xE9;aires</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/24">
<h1>Performance - Parsing</h1>

<pre class="sh_ruby"><code>    GC.disable
    Benchmark.bm{ |x| 
        x.report('~25    tags') { Liquid::Template.parse(template25) }
        x.report('~250   tags') { Liquid::Template.parse(template250) }
        x.report('~2500  tags') { Liquid::Template.parse(template2500) }
        x.report('~25000 tags') { Liquid::Template.parse(template25000) }
    }
    GC.enable

    ~25    tags  0.000000   0.000000   0.000000 (  0.001449)
    ~250   tags  0.010000   0.000000   0.010000 (  0.009970)
    ~2500  tags  0.100000   0.000000   0.100000 (  0.098813)
    ~25000 tags  1.020000   0.010000   1.030000 (  1.028419)</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/25">
<h1>Performance - Rendering</h1>

<ul>
<li>Pas terribles</li>
<li>Attention au GC !!!</li>
<li>Impl&#xE9;menter un block pour faire du fragment caching</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/26">
<h1>Solid - Qu'est-ce que c'est ?</h1>

<p>Une biblioth&#xE8;que qui aide &#xE0; cr&#xE9;er des tags liquid plus coh&#xE9;rents et plus facilement.</p></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/27">
<h1>Solid - Tags / Blocks - Arguments</h1>

<pre class="sh_ruby"><code>    class TypeOfTag &lt; Solid::Tag

      tag_name :typeof

      def display(*values)
        values.map{ |value| "&lt;p&gt;Type of #{value.inspect} is #{value.class.name}&lt;/p&gt;" }.join("\n")
      end

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/28">
<h1>Solid - Tags / Blocks - Arguments</h1>

<pre class="sh_html"><code>    {% capture myvar %}eggspam{% endcapture %}
    {% typeof "foo", 42, 4.2, myvar, /bb|[^b]{2}/, myoption:"bar", otheroption:myvar %}
    &lt;!-- produce --&gt;
    &lt;p&gt;Type of "foo" is String&lt;/p&gt;
    &lt;p&gt;Type of 42 is Fixnum&lt;/p&gt;
    &lt;p&gt;Type of 4.2 is Float&lt;/p&gt;
    &lt;p&gt;Type of "eggspam" is String&lt;/p&gt;
    &lt;p&gt;Type of /bb|[^b]{2}/ is Regexp&lt;/p&gt;
    &lt;p&gt;Type of {:myoption=&gt;"bar", :otheroption=&gt;"eggspam"} is Hash&lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/29">
<h1>Solid - Tags / Blocks - Context attributes</h1>

<pre class="sh_ruby"><code>    class HelloTag &lt; Solid::Tag

      tag_name :hello

      context_attribute :current_user

      def display
        "Hello #{current_user.name} !"
      end

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/30">
<h1>Solid - Blocks</h1>

<pre class="sh_ruby"><code>    class PBlock &lt; Solid::Block

      tag_name :p

      def display(options)
        "&lt;p class='#{options[:class]}'&gt;#{yield}&lt;/p&gt;"
      end

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/31">
<h1>Solid - Blocks</h1>

<pre class="sh_html"><code>    {% p class:"content" %}
      It works !
    {% endp %}
    &lt;!-- produce --&gt;
    &lt;p class="content"&gt;It works !&lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/32">
<h1>Solid - Conditional Blocks</h1>

<pre class="sh_ruby"><code>    class IfAlreadyVotedOn &lt; Solid::ConditionalBlock

      tag_name :if_already_voted_on

      context_attribute :current_user

      def display(post)
        yield(current_user.already_voted_on?(post))
      end

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/33">
<h1>Solid - Conditional Blocks</h1>

<pre class="sh_html"><code>    &lt;p&gt;
    {% if_already_voted_on post %}
        Remove my vote
    {% else %}
        Vote
    {% endif_already_voted_on %}
    &lt;/p&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/34">
<h1>Solid - Template</h1>

<ul>
<li>Totalement optionel</li>
<li>Facilite l'introspection (Enumerable)</li>
<li>Rails cache</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/35">
<h1>Solid - ModelDrop</h1>

<pre class="sh_ruby"><code>    class Post &lt; ActiveRecord::Base
      scope :published, where(:published =&gt; true)
      scope :with_comments, where('comments_count &gt; 0')

      class &lt;&lt; self
        liquid_methods :published, :with_comments
      end
    end

    SyntaxError: (eval):1: syntax error, unexpected $end
    ...Class &lt; Liquid::Drop; self; end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/36">
<h1>Solid - ModelDrop</h1>

<pre class="sh_ruby"><code>    class PostDrop &lt; Solid::ModelDrop

      allow_scopes :published, :with_comments

      respond :to =&gt; /sorted_by_(\w+)/, :with =&gt; :sort_by

      protected
      def sort_by(ordering)
        @scope = scope.sorted_by(ordering)
      end
      immutable_method :sort_by

    end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/37">
<h1>Solid - ModelDrop</h1>

<pre class="sh_html"><code>    {% for post in Post.published.with_comments.sorted_by_comments_count %}
        &lt;p&gt;{{ post.title }}&lt;/p&gt;
    {% endfor %}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/38">
<h1>Solid - Goodies</h1>

<p>Coloration syntaxique pour Ace</p>

<pre class="sh_javascript"><code>    //= require ace/mode-solid</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="one/01_slide/39">
<h1>References</h1>

<ul>
<li>Tigerlily: <a href="http://tigerlilyapps.com/">http://tigerlilyapps.com/</a></li>
<li>Rubygem: <a href="https://rubygems.org/gems/tigerlily-solid">https://rubygems.org/gems/tigerlily-solid</a></li>
<li>Github: <a href="https://github.com/tigerlily/solid">https://github.com/tigerlily/solid</a></li>
</ul>
</div>
</div></div>

</body>
</html>
